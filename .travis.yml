language:
    - cpp
    - python

python:
    - "2.7"

compiler: gcc

sudo: required

before_install:
  - sudo apt-add-repository ppa:boost-latest -y
  - sudo apt-add-repository ppa:mapnik/boost-backports-1-54 -y
  - sudo add-apt-repository ppa:ubuntu-toolchain-r/test -y
  - sudo apt-get clean -qq
  - sudo apt-get update -qq
  - sudo apt-get install -y libboost1.54-all-dev swig libc6-i386 lib32stdc++6 make time
  - sudo apt-get install -y python python-setuptools python-numpy python-pandas python-matplotlib python-cogent python-imaging python-qt4 python-pip python-lxml
  - if [ "$CXX" = "g++" ]; then sudo apt-get install g++-4.8; fi
  - if [ "$CXX" = "g++" ]; then sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.8 50; fi
  - if [ "$CXX" = "g++" ]; then sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.8 50; fi
  - sudo easy_install ete2
  - sudo easy_install hcluster
  - sudo easy_install bitarray
  - sed -i 's/TIME_UTC/TIME_UTC_/' src/libs/threadpool/boost/./threadpool/./detail/../task_adaptors.hpp

install:
  - GEN_SHARED=true make cnidaria

script:
  - scripts/cnidaria.py -h
  - make -C test fastas
  - SAMPLEDATA=true make -C test jfs
  - make -C test/out/test/ $PWD/test/out/test/test.all.csv

