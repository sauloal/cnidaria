if(!d3){throw"d3 wasn't included!"}(function(){function e(e,t){var n=function(e,t){t(e);if(e.children){for(var r=e.children.length-1;r>=0;r--){n(e.children[r],t)}}};n(e[0],function(e){e.rootDist=(e.parent?e.parent.rootDist:0)+(e.length||0)});var r=e.map(function(e){return e.rootDist});var i=d3.scale.linear().domain([0,d3.max(r)]).range([0,t]);n(e[0],function(e){e.y=i(e.rootDist)});return i}d3.phylogram={};d3.phylogram.rightAngleDiagonal=function(){function n(n,r){var i=n.source,s=n.target,o=(i.x+s.x)/2,u=(i.y+s.y)/2,a=[i,{x:s.x,y:i.y},s];a=a.map(e);return t(a)}var e=function(e){return[e.y,e.x]};var t=function(e){return"M"+e[0]+" "+e[1]+" "+e[2]};n.projection=function(t){if(!arguments.length)return e;e=t;return n};n.path=function(e){if(!arguments.length)return t;t=e;return n};return n};d3.phylogram.radialRightAngleDiagonal=function(){return d3.phylogram.rightAngleDiagonal().path(function(e){var t=e[0],n=e[1],r=e[2],i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),s=d3.phylogram.coordinateToAngle(t,i),o=d3.phylogram.coordinateToAngle(n,i),u=Math.abs(o-s)>Math.PI?o<=s:o>s,a=0,f=0,l=u?0:1;return"M"+t+" "+"A"+[i,i]+" "+a+" "+f+","+l+" "+n+"L"+r}).projection(function(e){var t=e.y,n=(e.x-90)/180*Math.PI;return[t*Math.cos(n),t*Math.sin(n)]})};d3.phylogram.coordinateToAngle=function(e,t){var n=2*Math.PI,r=n/4;var i=e[0]>=0?e[1]>=0?1:2:e[1]>=0?4:3,s=Math.abs(Math.asin(e[1]/t));switch(i){case 1:coordAngle=r-s;break;case 2:coordAngle=r+s;break;case 3:coordAngle=2*r+r-s;break;case 4:coordAngle=3*r+s}return coordAngle};d3.phylogram.styleTreeNodes=function(e){e.selectAll("g.leaf.node").append("svg:circle").attr("r",4.5).attr("stroke","yellowGreen").attr("fill","greenYellow").attr("stroke-width","2px");e.selectAll("g.root.node").append("svg:circle").attr("r",4.5).attr("fill","steelblue").attr("stroke","#369").attr("stroke-width","2px")};d3.phylogram.build=function(t,n,r){r=r||{};var i=r.width||d3.select(t).style("width")||d3.select(t).attr("width"),s=r.height||d3.select(t).style("height")||d3.select(t).attr("height"),i=parseInt(i),s=parseInt(s);var o=r.tree||d3.layout.tree().size([s,i]).sort(function(e){return e.children?e.children.length:-1}).children(r.children||function(e){return e.branchset});var u=r.diagonal||d3.phylogram.rightAngleDiagonal();var a=r.vis||d3.select(t).append("svg:svg").attr("width",i+300).attr("height",s+30).append("svg:g").attr("transform","translate(20, 20)");var n=o(n);if(r.skipBranchLengthScaling){var f=d3.scale.linear().domain([0,i]).range([0,i])}else{var f=e(n,i)}if(!r.skipTicks){a.selectAll("line").data(f.ticks(10)).enter().append("svg:line").attr("y1",0).attr("y2",s).attr("x1",f).attr("x2",f).attr("stroke","#ddd");a.selectAll("text.rule").data(f.ticks(10)).enter().append("svg:text").attr("class","rule").attr("x",f).attr("y",0).attr("dy",-3).attr("text-anchor","middle").attr("font-size","8px").attr("fill","#ccc").text(function(e){return Math.round(e*100)/100})}var l=a.selectAll("path.link").data(o.links(n)).enter().append("svg:path").attr("class","link").attr("d",u).attr("fill","none").attr("stroke","#aaa").attr("stroke-width","4px");var c=a.selectAll("g.node").data(n).enter().append("svg:g").attr("class",function(e){if(e.children){if(e.depth==0){return"root node"}else{return"inner node"}}else{return"leaf node"}}).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});d3.phylogram.styleTreeNodes(a);if(!r.skipLabels){a.selectAll("g.inner.node").append("svg:text").attr("dx",-6).attr("dy",-6).attr("text-anchor","end").attr("font-size","8px").attr("fill","#ccc").text(function(e){return e.length});a.selectAll("g.leaf.node").append("svg:text").attr("dx",8).attr("dy",3).attr("text-anchor","start").attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(e){return e.data.name+" ("+e.length+")"})}return{tree:o,vis:a}};d3.phylogram.buildRadial=function(e,t,n){n=n||{};var r=n.width||d3.select(e).style("width")||d3.select(e).attr("width"),i=r/2,s=n.skipLabels?10:n.labelWidth||120;var o=d3.select(e).append("svg:svg").attr("width",i*2).attr("height",i*2).append("svg:g").attr("transform","translate("+i+","+i+")");var u=d3.layout.tree().size([360,i-s]).sort(function(e){return e.children?e.children.length:-1}).children(n.children||function(e){return e.branchset}).separation(function(e,t){return(e.parent==t.parent?1:2)/e.depth});var a=d3.phylogram.build(e,t,{vis:o,tree:u,skipBranchLengthScaling:true,skipTicks:true,skipLabels:n.skipLabels,diagonal:d3.phylogram.radialRightAngleDiagonal()});o.selectAll("g.node").attr("transform",function(e){return"rotate("+(e.x-90)+")translate("+e.y+")"});if(!n.skipLabels){o.selectAll("g.leaf.node text").attr("dx",function(e){return e.x<180?8:-8}).attr("dy",".31em").attr("text-anchor",function(e){return e.x<180?"start":"end"}).attr("transform",function(e){return e.x<180?null:"rotate(180)"}).attr("font-family","Helvetica Neue, Helvetica, sans-serif").attr("font-size","10px").attr("fill","black").text(function(e){return e.data.name});o.selectAll("g.inner.node text").attr("dx",function(e){return e.x<180?-6:6}).attr("text-anchor",function(e){return e.x<180?"end":"start"}).attr("transform",function(e){return e.x<180?null:"rotate(180)"})}return{tree:u,vis:o}}})()